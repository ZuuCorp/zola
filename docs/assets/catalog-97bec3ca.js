class t{constructor(){this.tracks=[],this.albums=[],this.source="itunes"}async init(){try{await this.fetchItunesAlbums("Zola"),await this.fetchItunesTracks("Zola"),this.dispatchEvent("catalog:loaded",{total:this.tracks.length,albums:this.albums.length})}catch(t){}}async fetchItunesAlbums(t){const e=`https://itunes.apple.com/search?term=${encodeURIComponent(t)}&entity=album&limit=20&country=FR`,a=await fetch(e,{mode:"cors"});if(!a.ok)return;const s=await a.json();this.albums=(s.results||[]).filter(t=>"Album"===t.collectionType||"Album"===t.collectionType).map(t=>({id:t.collectionId,title:t.collectionName,cover:(t.artworkUrl100||"").replace("100x100bb","600x600bb"),url:t.collectionViewUrl,artist:t.artistName,releaseDate:t.releaseDate}))}async fetchItunesTracks(t){const e=`https://itunes.apple.com/search?term=${encodeURIComponent(t)}&entity=song&limit=100&country=FR`,a=await fetch(e,{mode:"cors"});if(!a.ok)return;const s=await a.json();this.tracks=(s.results||[]).map(t=>({id:t.trackId,title:t.trackName,album:t.collectionName,artist:t.artistName,cover:(t.artworkUrl100||"").replace("100x100bb","600x600bb"),previewUrl:t.previewUrl,genre:t.primaryGenreName,releaseDate:t.releaseDate})).filter(t=>!!t.previewUrl)}getTracks(){return this.tracks}getAlbums(){return this.albums}dispatchEvent(t,e={}){const a=new CustomEvent(t,{detail:{...e,timestamp:Date.now()}});window.dispatchEvent(a)}}export{t as W};
